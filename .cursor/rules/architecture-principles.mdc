---
description:
globs:
alwaysApply: true
---
# ğŸ—ï¸ Architecture Principles - Softwhere.uz

## Core Layered Architecture Pattern

This project follows [Arno's Next.js Architecture Guide](mdc:https:/arno.surfacew.com/posts/nextjs-architecture) with a strict 5-layer architecture:

```
Client Layer â†’ Controller Layer â†’ Service Layer â†’ Manager Layer â†’ Data Layer
```

## Layer Structure

### ğŸ¨ Client Layer
- **Location**: [src/components/](mdc:src/components), [src/app/[locale]/](mdc:src/app/[locale]/)
- **Purpose**: UI rendering, user interactions, and presentation logic
- **Rules**: No business logic, no direct API calls to external services

### ğŸ›ï¸ Controller Layer
- **Location**: [src/app/api/](mdc:src/app/api)
- **Purpose**: HTTP request/response handling, routing, middleware
- **Rules**: ZERO business logic, delegate everything to services

### ğŸ”§ Service Layer
- **Location**: [src/services/](mdc:src/services)
- **Purpose**: Business logic, domain operations, orchestration
- **Examples**: [BlogService](mdc:src/services/blog.service.ts), [AdminService](mdc:src/services/admin.service.ts)

### âš™ï¸ Manager Layer
- **Location**: [src/managers/](mdc:src/managers)
- **Purpose**: Data operations, external API integrations, utilities
- **Examples**: [BlogManager](mdc:src/managers/blog.manager.ts), [ValidationManager](mdc:src/managers/validation.manager.ts)

### ğŸ’¾ Data Layer
- **Location**: [src/models/](mdc:src/models), [src/lib/](mdc:src/lib)
- **Purpose**: Database models, external service connections
- **Examples**: [BlogPost.ts](mdc:src/models/BlogPost.ts), [db.ts](mdc:src/lib/db.ts)

## Import Direction Rules

**ALLOWED:**
- Client â†’ Controller (HTTP requests)
- Controller â†’ Service (business logic delegation)
- Service â†’ Manager (data operations)
- Manager â†’ Data (database/external APIs)
- Any layer â†’ [Utils](mdc:src/utils), [Constants](mdc:src/constants), [Types](mdc:src/types)

**FORBIDDEN:**
- Reverse imports (Manager â†’ Service, Service â†’ Controller)
- Layer skipping (Controller â†’ Manager directly)
- Circular dependencies

## Domain-Driven Design

Follow DDD principles with clear domain boundaries:
- **Blog Domain**: Content management, publishing, SEO
- **Admin Domain**: Administrative operations, user management
- **Estimator Domain**: Project estimation, AI integration
- **Generation Domain**: AI content creation, automation

## Architecture Goals

1. **Separation of Concerns**: Each layer has single responsibility
2. **Testability**: Isolated, mockable components
3. **Maintainability**: Clear code organization and patterns
4. **Scalability**: Easy to extend with new features
5. **Type Safety**: Comprehensive TypeScript coverage
